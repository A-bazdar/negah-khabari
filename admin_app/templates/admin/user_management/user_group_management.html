{% extends '../admin_base.html' %}

{% block other_css %}
<link rel="stylesheet" href="{{ static_url('plugins/DatePicker/pwt-datepicker.css') }}">
<link rel="stylesheet" href="{{ static_url('plugins/Lc_Switch/lc_switch.css') }}">
<link rel="stylesheet" type="text/css" href="/static/plugins/bootstrap-fileupload/bootstrap-fileupload.css" />
{% end block other_css %}

{% block container %}
    <div id="page-wrapper">
        <div class="row">
            <div class="col-lg-12">
                <div class="panel panel-default margin-top-30 font-yekan">
                    <div class="panel-heading"><i class="fa fa-folder-open-o"></i><span>مدیریت گروه های کاربری</span> </div>
                    <div class="panel-body">
                        <div class="show_box">
                            <div class="box_header">
                                <span>فهرست کاربران</span>
                            </div>
                            <div class="box_body">
                                <div>
                                    <div class="row">
                                        <div class="col-md-8 col-sm-8 col-md-offset-2 col-sm-offset-2">
                                            <div class="direction_form display-none close">
                                                <form id="add_user_group">
                                                    {% module xsrf_form_html() %}
                                                    <input type="hidden" name="action" value="add">
                                                    <div class="row">
                                                        <div class="col-md-3 col-sm-3">
                                                            <span class="form_label">نام گروه</span>
                                                        </div>
                                                        <div class="col-md-7 col-sm-7">
                                                            <input type="text" name="group-name" class="form-control">
                                                        </div>
                                                        <div class="col-md-2 col-sm-2 text-left">
                                                            <button type="submit" class="btn R_butt_green add-user-group-btn">افزودن</button>
                                                        </div>
                                                    </div>
                                                </form>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row margin-top-10">
                                        <div class="col-md-8 col-sm-8 col-md-offset-2 col-sm-offset-2">
                                            <div class="row">
                                                <div class="col-md-3 col-sm-3 text-left pull-left">
                                                    <button class="btn add_direction R_butt_gray">افزودن </button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row margin-top-20">
                                        <div class="col-md-8 col-sm-8 col-md-offset-2 col-sm-offset-2">
                                            <table class="table table-bordered source_news_table user-groups-table">
                                                <tr>
                                                    <td>نام گروه</td>
                                                    <td>تعداد اعضا</td>
                                                    <td>امکانات</td>
                                                </tr>
                                                {% for group in user_groups %}
                                                    <tr class="group-row">
                                                        <td>{{ group['name'] }}</td>
                                                        <td>{{ group['count_user'] }}</td>
                                                        <td>
                                                            <i class="fa fa-pencil"></i>
                                                            <i class="fa fa-wrench setting-group" data-id="{{ group['id'] }}"></i>
                                                            <span class="delete-group" data-group="{{ group['id'] }}">
                                                                <i class="fa fa-trash-o"></i>
                                                            </span>
                                                        </td>
                                                    </tr>
                                                {% end %}
                                                {% if not len(user_groups) %}
                                                    <tr class="empty">
                                                        <td colspan="3">موردی وجود ندارد.</td>
                                                    </tr>
                                                {% end %}
                                            </table>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="box_footer">
                                <div class="row margin-top-10">
                                    <div class="col-xs-2">
                                        <button class="btn R_butt_blue">چیدن موضوعات</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>


    <div class="modal fade in" id="user_group_modal" tabindex="-1" role="basic" aria-hidden="false">
        <div class="modal-dialog" style="font-family: Yekan;width: 60%">
            <div class="modal-content" style="border-radius: 7px !important">
                <div class="show_box">
                    <div class="box_header">
                        <div class="row">
                            <div class="col-xs-11">
                                <span>تعیین سطح دسترسی ها</span>
                            </div>
                            <div class="col-xs-1">
                                <span class="cursor fa fa-times"
                                      style="font-size:12pt;color: #828282;margin-top: 5px;cursor: pointer"
                                      data-dismiss="modal" aria-hidden="true"></span>
                            </div>
                        </div>
                    </div>
                    <div class="box_body" style="padding: 50px 10px">
                        <div class="row">
                            <div class="col-xs-10 col-xs-offset-1">
                                <div class="show_box" data-action="1">
                                    <div class="box_header" style="padding-bottom: 0; font-size: 9pt">
                                        <!-- Nav tabs -->
                                        <ul class="nav nav-tabs" role="tablist">
                                            <li role="presentation" class="active">
                                                <a class="dir_tab" data-action="1" aria-controls="source" role="tab" data-toggle="tab">جستجو و الگوها</a>
                                            </li>
                                            <li role="presentation">
                                                <a class="dir_tab" data-action="2" aria-controls="content" role="tab" data-toggle="tab">دسترسی به منابع خبری</a>
                                            </li>
                                            <li role="presentation">
                                                <a class="dir_tab" data-action="3" aria-controls="content" role="tab" data-toggle="tab">مدیریت بولتن</a>
                                            </li>
                                            <li role="presentation">
                                                <a class="dir_tab" data-action="4" aria-controls="content" role="tab" data-toggle="tab">نمودار و تحلیل محتوا</a>
                                            </li>
                                        </ul>
                                    </div>
                                    <div class="box_body">
                                        <div class="tab_content" data-action="1">
                                            <form id="search_and_patterns">
                                                {% module xsrf_form_html() %}
                                                <input name="group-id" type="hidden" class="setting-group-id">
                                                <input name="action" value="search_and_patterns" type="hidden">
                                                <div class="row">
                                                    <div class="col-md-4 col-sm-4">
                                                        <div class="row">
                                                            <div class="col-md-6 col-sm-6">
                                                                <span class="form_label">جستجوی ساده</span>
                                                            </div>
                                                            <div class="col-md-6 col-sm-6">
                                                                <input type="checkbox" value="1" name="simple-search">
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="col-md-4 col-sm-4">
                                                        <div class="row">
                                                            <div class="col-md-6 col-sm-6">
                                                                <span class="form_label">جستجوی پیشرفته</span>
                                                            </div>
                                                            <div class="col-md-6 col-sm-6">
                                                                <input type="checkbox" value="1" name="advanced-search">
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="col-md-4 col-sm-4">
                                                        <div class="row">
                                                            <div class="col-md-6 col-sm-6">
                                                                <span class="form_label">پالایش اخبار</span>
                                                            </div>
                                                            <div class="col-md-6 col-sm-6">
                                                                <input type="checkbox" value="1" name="refining-news">
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="row margin-top-10">
                                                    <div class="col-md-4 col-sm-4">
                                                        <div class="row">
                                                            <div class="col-md-6 col-sm-6">
                                                                <span class="form_label">الگوی منابع خبری</span>
                                                            </div>
                                                            <div class="col-md-6 col-sm-6">
                                                                <input type="checkbox" name="pattern-sources" value="1">
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="col-md-8 col-sm-8">
                                                        <div class="row">
                                                            <div class="col-md-4 col-sm-4">
                                                                <span class="form_label">تعداد الگو</span>
                                                            </div>
                                                            <div class="col-md-8 col-sm-8">
                                                                <input type="text" name="count-pattern-sources" class="form-control">
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="row margin-top-10">
                                                    <div class="col-md-4 col-sm-4">
                                                        <div class="row">
                                                            <div class="col-md-6 col-sm-6">
                                                                <span class="form_label">الگوی جستجو</span>
                                                            </div>
                                                            <div class="col-md-6 col-sm-6">
                                                                <input type="checkbox" value="1" name="pattern-search">
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="col-md-8 col-sm-8">
                                                        <div class="row">
                                                            <div class="col-md-4 col-sm-4">
                                                                <span class="form_label">تعداد الگو</span>
                                                            </div>
                                                            <div class="col-md-8 col-sm-8">
                                                                <input type="text" class="form-control" name="count-pattern-search">
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="row margin-top-10">
                                                    <div class="col-md-12 text-left">
                                                        <div class="btn R_butt_light_gray" data-dismiss="modal">انصراف</div>
                                                        <button class="btn R_butt_green search-and-patterns-btn">ثبت</button>
                                                    </div>
                                                </div>
                                            </form>
                                        </div>
                                        <div class="tab_content display-none" data-action="2">
                                            <form id="access_sources">
                                                {% module xsrf_form_html() %}
                                                <input name="group-id" type="hidden" class="setting-group-id">
                                                <input name="action" value="access_sources" type="hidden">
                                                <div class="row">
                                                    <div class="col-md-12 col-sm-12">
                                                        <div class="form_modal_body margin-top-10" id="media">
                                                            <span class="form_body_title">رسانه / منبع</span>
                                                            <div class="row">
                                                                <div class="col-md-4 col-sm-4">
                                                                    {% for category in categories %}
                                                                        <div class="row margin-top-5">
                                                                            <div class="col-md-12 col-sm-12">
                                                                                <div class="R_butt_white_bordered" data-action="{{ category['id'] }}">{{ category['name'] }}</div>
                                                                            </div>
                                                                        </div>
                                                                    {% end %}
                                                                </div>
                                                                {% set a = False %}
                                                                {% for category in categories %}
                                                                    <div class="col-md-8 col-sm-8 source_content {% if a %}display-none{% else %}{% set a = True %}{% end %}" data-action="{{ category['id'] }}">
                                                                        <div class="row">
                                                                            <div class="col-md-12 col-sm-12">
                                                                                <div class="tree_container">
                                                                                    <input class="parent" data-id="{{ category['id'] }}" type="checkbox">
                                                                                    <span class="form_label">{{ category['name'] }}</span>
                                                                                </div>
                                                                            </div>
                                                                            {% for agency in category['agencies'] %}
                                                                                <div class="col-md-11 col-sm-11 col-md-push-1 col-sm-push-1">
                                                                                    <div class="tree_container">
                                                                                        <input class="child" value="{{ agency['id'] }}" data-id="{{ agency['id'] }}" data-parent-id="{{ category['id'] }}" name="agency" type="checkbox">
                                                                                        <span class="form_label">{{ agency['name'] }}</span>
                                                                                    </div>
                                                                                </div>
                                                                            {% end %}
                                                                        </div>
                                                                    </div>
                                                                {% end %}
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="row margin-top-10">
                                                    <div class="col-md-12 col-sm-12">
                                                        <div class="form_modal_body margin-top-10" id="subject">
                                                            <span class="form_body_title">موضوع</span>
                                                            <div class="row">
                                                                <div class="col-md-4 col-sm-4">
                                                                    {% for subject in subjects %}
                                                                        <div class="row margin-top-5">
                                                                            <div class="col-md-12 col-sm-12">
                                                                                <div class="R_butt_white_bordered" data-action="{{ subject['id'] }}">{{ subject['name'] }}</div>
                                                                            </div>
                                                                        </div>
                                                                    {% end %}
                                                                </div>
                                                                {% set a = False %}
                                                                {% for subject in subjects %}
                                                                    <div class="col-md-8 col-sm-8 source_content {% if a %}display-none{% else %}{% set a = True %}{% end %}" data-action="{{ subject['id'] }}">
                                                                        <div class="row">
                                                                            <div class="col-md-12 col-sm-12">
                                                                                <div class="tree_container">
                                                                                    <input class="parent" data-id="{{ subject['id'] }}" type="checkbox">
                                                                                    <span class="form_label">{{ subject['name'] }}</span>
                                                                                </div>
                                                                            </div>
                                                                            {% for child in subject['child'] %}
                                                                                <div class="col-md-11 col-sm-11 col-md-push-1 col-sm-push-1">
                                                                                    <div class="tree_container">
                                                                                        <input class="child" data-id="{{ child['id'] }}" value="{{ child['id'] }}" name="subject" data-parent-id="{{ subject['id'] }}" type="checkbox">
                                                                                        <span class="form_label">{{ child['name'] }}</span>
                                                                                    </div>
                                                                                </div>
                                                                            {% end %}
                                                                        </div>
                                                                    </div>
                                                                {% end %}
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="row margin-top-10">
                                                    <div class="col-md-12 col-sm-12">
                                                        <div class="form_modal_body margin-top-10" id="area">
                                                            <span class="form_body_title">حوزه</span>
                                                            <div class="row">
                                                                <div class="col-md-4 col-sm-4">
                                                                    {% for geo in geographic %}
                                                                        <div class="row margin-top-5">
                                                                            <div class="col-md-12 col-sm-12">
                                                                                <div class="R_butt_white_bordered" data-action="{{ geo['id'] }}">{{ geo['name'] }}</div>
                                                                            </div>
                                                                        </div>
                                                                    {% end %}
                                                                </div>
                                                                {% set a = False %}
                                                                {% for geo in geographic %}
                                                                    <div class="col-md-8 col-sm-8 source_content {% if a %}display-none{% else %}{% set a = True %}{% end %}" data-action="{{ geo['id'] }}">
                                                                        <div class="row">
                                                                            <div class="col-md-12 col-sm-12">
                                                                                <div class="tree_container">
                                                                                    <input class="parent" data-id="{{ geo['id'] }}" type="checkbox">
                                                                                    <span class="form_label">{{ geo['name'] }}</span>
                                                                                </div>
                                                                            </div>
                                                                            {% for child in geo['child'] %}
                                                                                <div class="col-md-11 col-sm-11 col-md-push-1 col-sm-push-1">
                                                                                    <div class="tree_container">
                                                                                        <input name="geographic" data-id="{{ child['id'] }}" value="{{ child['id'] }}" class="child" data-parent-id="{{ geo['id'] }}" type="checkbox">
                                                                                        <span class="form_label">{{ child['name'] }}</span>
                                                                                    </div>
                                                                                </div>
                                                                            {% end %}
                                                                        </div>
                                                                    </div>
                                                                {% end %}
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="row margin-top-10">
                                                    <div class="col-md-12 text-left">
                                                        <button class="btn R_butt_light_gray" data-dismiss="modal">انصراف</button>
                                                        <button class="btn R_butt_green access-source-btn">ثبت</button>
                                                    </div>
                                                </div>
                                            </form>
                                        </div>
                                        <div class="tab_content display-none" data-action="3">
                                            <form id="bolton_management">
                                                {% module xsrf_form_html() %}
                                                <input name="group-id" type="hidden" class="setting-group-id">
                                                <input name="action" value="bolton_management" type="hidden">
                                                <div class="row">
                                                    <div class="col-md-12 col-sm-12">
                                                        <div class="row">
                                                            <div class="col-md-2 col-sm-3">
                                                                <span class="form_label">نام بولتن</span>
                                                            </div>
                                                            <div class="col-md-6 col-sm-6">
                                                                <input name="bolton-name" type="text" class="form-control">
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="row margin-top-10">
                                                    <div class="col-md-4 col-sm-4">
                                                        <div class="row">
                                                            <div class="col-md-6 col-sm-6">
                                                                <span class="form_label">ساخت بولتن</span>
                                                            </div>
                                                            <div class="col-md-6 col-sm-6">
                                                                <input name="make-bolton" type="checkbox">
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="col-md-4 col-sm-4">
                                                        <div class="row">
                                                            <div class="col-md-6 col-sm-6">
                                                                <span class="form_label">تعداد بولتن</span>
                                                            </div>
                                                            <div class="col-md-6 col-sm-6">
                                                                <input name="bolton-count" type="text" class="form-control">
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="col-md-4 col-sm-4">
                                                        <div class="row">
                                                            <div class="col-md-6 col-sm-6">
                                                                <span class="form_label">تعداد بخش</span>
                                                            </div>
                                                            <div class="col-md-6 col-sm-6">
                                                                <input name="bolton-count-part" type="text" class="form-control">
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="row margin-top-10">
                                                    <div class="col-md-4 col-sm-4">
                                                        <div class="row">
                                                            <div class="col-md-6 col-sm-6">
                                                                <span class="form_label">ساخت بولتن خودکار</span>
                                                            </div>
                                                            <div class="col-md-6 col-sm-6">
                                                                <input name="make-bolton-automatic" type="checkbox">
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="col-md-4 col-sm-4">
                                                        <div class="row">
                                                            <div class="col-md-6 col-sm-6">
                                                                <span class="form_label">تعداد بولتن</span>
                                                            </div>
                                                            <div class="col-md-6 col-sm-6">
                                                                <input name="bolton-automatic-count" type="text" class="form-control">
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="col-md-4 col-sm-4">
                                                        <div class="row">
                                                            <div class="col-md-6 col-sm-6">
                                                                <span class="form_label">تعداد بخش</span>
                                                            </div>
                                                            <div class="col-md-6 col-sm-6">
                                                                <input type="text" name="bolton-automatic-count-part" class="form-control">
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="row margin-top-10">
                                                    <div class="col-md-4 col-sm-4">
                                                        <div class="row">
                                                            <div class="col-md-6 col-sm-6">
                                                                <span class="form_label">روزنامه</span>
                                                            </div>
                                                            <div class="col-md-6 col-sm-6">
                                                                <input name="make-newspaper" type="checkbox">
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="col-md-4 col-sm-4">
                                                        <div class="row">
                                                            <div class="col-md-6 col-sm-6">
                                                                <span class="form_label">تعداد روزنامه</span>
                                                            </div>
                                                            <div class="col-md-6 col-sm-6">
                                                                <input name="newspaper-count" type="text" class="form-control">
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="col-md-4 col-sm-4">
                                                        <div class="row">
                                                            <div class="col-md-6 col-sm-6">
                                                                <span class="form_label">تعداد بخش</span>
                                                            </div>
                                                            <div class="col-md-6 col-sm-6">
                                                                <input name="newspaper-count-part" type="text" class="form-control">
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="row margin-top-10">
                                                    <div class="col-md-3 col-sm-3">
                                                        <span class="form_label">مدت ویرایش بولتن</span>
                                                    </div>
                                                    <div class="col-md-2 col-sm-2">
                                                        <input type="text" name="time-edit-bolton" class="form-control">
                                                    </div>
                                                    <div class="col-md-1 col-sm-1"><span class="form_label">روز</span></div>
                                                    <div class="col-md-3 col-sm-3">
                                                        <span class="form_label">مدت ویرایش روزنامه</span>
                                                    </div>
                                                    <div class="col-md-2 col-sm-2">
                                                        <input type="text" name="time-edit-newspaper" class="form-control">
                                                    </div>
                                                    <div class="col-md-1 col-sm-1"><span class="form_label">روز</span></div>
                                                </div>
                                                <div class="row margin-top-10">
                                                    <div class="col-md-12 text-left">
                                                        <button class="btn R_butt_light_gray" data-dismiss="modal">انصراف</button>
                                                        <button class="btn R_butt_green bolton-management-btn">ثبت</button>
                                                    </div>
                                                </div>
                                            </form>
                                        </div>
                                        <div class="tab_content display-none" data-action="4">
                                            <form id="charts_content">
                                                {% module xsrf_form_html() %}
                                                <input name="group-id" type="hidden" class="setting-group-id">
                                                <input name="action" value="charts_content" type="hidden">
                                                <div class="row">
                                                    <div class="col-md-12 col-sm-12">
                                                        <div class="form_modal_body margin-top-10">
                                                            <span class="form_body_title">نمودار و آمار</span>
                                                            <div class="row">
                                                                <div class="col-md-4 col-sm-4">
                                                                    <div class="row">
                                                                        <div class="col-md-6 col-sm-6">
                                                                            <span class="form_label">قالب محتوا</span>
                                                                        </div>
                                                                        <div class="col-md-6 col-sm-6">
                                                                            <input name="content-format" type="checkbox">
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                                <div class="col-md-4 col-sm-4">
                                                                    <div class="row">
                                                                        <div class="col-md-6 col-sm-6">
                                                                            <span class="form_label">اهمیت خبر</span>
                                                                        </div>
                                                                        <div class="col-md-6 col-sm-6">
                                                                            <input name="importance-news" type="checkbox">
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                                <div class="col-md-4 col-sm-4">
                                                                    <div class="row">
                                                                        <div class="col-md-6 col-sm-6">
                                                                            <span class="form_label">عملکرد منابع خبری بر اساس تعداد اخبار</span>
                                                                        </div>
                                                                        <div class="col-md-6 col-sm-6">
                                                                            <input name="based-count-news" type="checkbox">
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="row margin-top-10">
                                                                <div class="col-md-4 col-sm-4">
                                                                    <div class="row">
                                                                        <div class="col-md-6 col-sm-6">
                                                                            <span class="form_label">آمار کلی منابع خبری</span>
                                                                        </div>
                                                                        <div class="col-md-6 col-sm-6">
                                                                            <input name="stats-news" type="checkbox">
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                                <div class="col-md-4 col-sm-4">
                                                                    <div class="row">
                                                                        <div class="col-md-6 col-sm-6">
                                                                            <span class="form_label">آمار روزانه انتشار اخبار</span>
                                                                        </div>
                                                                        <div class="col-md-6 col-sm-6">
                                                                            <input name="daily-news" type="checkbox">
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                                <div class="col-md-4 col-sm-4">
                                                                    <div class="row">
                                                                        <div class="col-md-6 col-sm-6">
                                                                            <span class="form_label">مهمترین سرفصل های خبری</span>
                                                                        </div>
                                                                        <div class="col-md-6 col-sm-6">
                                                                            <input name="news-headlines" type="checkbox">
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="row margin-top-10">
                                                                <div class="col-md-4 col-sm-4">
                                                                    <div class="row">
                                                                        <div class="col-md-6 col-sm-6">
                                                                            <span class="form_label">مهمترین تگ های خبری</span>
                                                                        </div>
                                                                        <div class="col-md-6 col-sm-6">
                                                                            <input name="tags-news" type="checkbox">
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                                <div class="col-md-4 col-sm-4">
                                                                    <div class="row">
                                                                        <div class="col-md-6 col-sm-6">
                                                                            <span class="form_label">بازتاب خبری</span>
                                                                        </div>
                                                                        <div class="col-md-6 col-sm-6">
                                                                            <input name="reflecting-news" type="checkbox">
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                                <div class="col-md-4 col-sm-4">
                                                                    <div class="row">
                                                                        <div class="col-md-6 col-sm-6">
                                                                            <span class="form_label">اهمیت خبر در جایگاه رسانه</span>
                                                                        </div>
                                                                        <div class="col-md-6 col-sm-6">
                                                                            <input name="importance-media" type="checkbox">
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="form_modal_body margin-top-20">
                                                            <span class="form_body_title">تحلیل محتوا</span>
                                                            <div class="row">
                                                                <div class="col-md-4 col-sm-4">
                                                                    <div class="row">
                                                                        <div class="col-md-6 col-sm-6">
                                                                            <span class="form_label">جهت گیری مثبت و منفی</span>
                                                                        </div>
                                                                        <div class="col-md-6 col-sm-6">
                                                                            <input name="positive-negative-orientation" type="checkbox">
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                                <div class="col-md-4 col-sm-4">
                                                                    <div class="row">
                                                                        <div class="col-md-6 col-sm-6">
                                                                            <span class="form_label">جهت گیری منابع خبری</span>
                                                                        </div>
                                                                        <div class="col-md-6 col-sm-6">
                                                                            <input name="orientation-news-sources" type="checkbox">
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                                <div class="col-md-4 col-sm-4">
                                                                    <div class="row">
                                                                        <div class="col-md-6 col-sm-6">
                                                                            <span class="form_label">مهمترین خبرسازان</span>
                                                                        </div>
                                                                        <div class="col-md-6 col-sm-6">
                                                                            <input name="important-news-makers" type="checkbox">
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="row margin-top-10">
                                                                <div class="col-md-4 col-sm-4">
                                                                    <div class="row">
                                                                        <div class="col-md-6 col-sm-6">
                                                                            <span class="form_label">منابع اصلی اخبار 1</span>
                                                                        </div>
                                                                        <div class="col-md-6 col-sm-6">
                                                                            <input name="main-sources-news-1" type="checkbox">
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                                <div class="col-md-4 col-sm-4">
                                                                    <div class="row">
                                                                        <div class="col-md-6 col-sm-6">
                                                                            <span class="form_label">منابع اصلی اخبار 2</span>
                                                                        </div>
                                                                        <div class="col-md-6 col-sm-6">
                                                                            <input name="main-sources-news-2" type="checkbox">
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="row margin-top-10">
                                                    <div class="col-md-12 text-left">
                                                        <button class="btn R_butt_light_gray" data-dismiss="modal">انصراف</button>
                                                        <button class="btn R_butt_green charts-content-btn">ثبت</button>
                                                    </div>
                                                </div>
                                            </form>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
{% end block container %}

{% block other_scripts %}
<script src="{{ static_url('plugins/DatePicker/pwt-date.js') }}"></script>
<script src="{{ static_url('plugins/DatePicker/pwt-datepicker.js') }}"></script>
<script src="{{ static_url('plugins/Lc_Switch/lc_switch.min.js') }}"></script>
<script type="text/javascript" src="/static/plugins/bootstrap-fileupload/bootstrap-fileupload.js"></script>
<script>
$('.add_direction').click(function(){
    if($('.direction_form').hasClass('close')){
        $('.direction_form').slideDown();
        $('.direction_form').removeClass('close');
        $('.direction_form').addClass('open');
        $(this).html('بستن');
    }
    else if($('.direction_form').hasClass('open')){
        $('.direction_form').slideUp();
        $('.direction_form').removeClass('open');
        $('.direction_form').addClass('close');
        $(this).html('افزودن ');
    }
});

$('input[type=checkbox]').lc_switch();

$('body').delegate('input.parent[type=checkbox]', 'lcs-statuschange', function() {
    var parent_id = $(this).attr('data-id');
    if($(this).is(':checked')){
        $('input.child[type=checkbox][data-parent-id=' + parent_id + ']').lcs_on();
    }else{
        $('input.child[type=checkbox][data-parent-id=' + parent_id + ']').lcs_off();
    }
}).delegate('input[name=make-bolton]', 'lcs-statuschange', function() {
    if(!$(this).is(':checked')){
        $('input[name=bolton-count]').val('').attr('disabled', 'disabled');
        $('input[name=bolton-count-part]').val('').attr('disabled', 'disabled');
    }else{
        $('input[name=bolton-count]').removeAttr('disabled');
        $('input[name=bolton-count-part]').removeAttr('disabled');
    }
}).delegate('input[name=make-bolton-automatic]', 'lcs-statuschange', function() {
    if(!$(this).is(':checked')){
        $('input[name=bolton-automatic-count]').val('').attr('disabled', 'disabled');
        $('input[name=bolton-automatic-count-part]').val('').attr('disabled', 'disabled');
    }else{
        $('input[name=bolton-automatic-count]').removeAttr('disabled');
        $('input[name=bolton-automatic-count-part]').removeAttr('disabled');
    }
}).delegate('input[name=make-newspaper]', 'lcs-statuschange', function() {
    if(!$(this).is(':checked')){
        $('input[name=newspaper-count]').val('').attr('disabled', 'disabled');
        $('input[name=newspaper-count-part]').val('').attr('disabled', 'disabled');
    }else{
        $('input[name=newspaper-count]').removeAttr('disabled');
        $('input[name=newspaper-count-part]').removeAttr('disabled');
    }
});


$('.dir_tab').click(function(){
    var data_action = $(this).attr('data-action');
    $('.tab_content').css('display','none');
    $('.tab_content[data-action=' + data_action + ']').fadeIn();
});
$('#media .R_butt_white_bordered').click(function(){
    var data_action = $(this).attr('data-action');
    $('#media .source_content').css('display','none');
    $('#media .source_content[data-action=' + data_action + ']').fadeIn();
});
$('#subject .R_butt_white_bordered').click(function(){
    var data_action = $(this).attr('data-action');
    $('#subject .source_content').css('display','none');
    $('#subject .source_content[data-action=' + data_action + ']').fadeIn();
});
$('#area .R_butt_white_bordered').click(function(){
    var data_action = $(this).attr('data-action');
    $('#area .source_content').css('display','none');
    $('#area .source_content[data-action=' + data_action + ']').fadeIn();
});


var trash = '<i class="fa fa-trash-o"></i>';
var loader = '<img src="{{ static_url('images/loading.gif') }}" width="20" height="20">';

var content = '<tr class="group-row">\
                <td>__name__</td>\
                <td>0</td>\
                <td>\
                    <i class="fa fa-pencil"></i>\
                    <i class="fa fa-wrench" data-toggle="modal" href="#user_group_modal"></i>\
                        <span class="delete-group" data-group="__id__">\
                            <i class="fa fa-trash-o"></i>\
                        </span>\
                </td>\
            </tr>';

var __a = true;
$('#add_user_group').submit(function(e){
    if(__a){
        __a = false;
        e.preventDefault();
        var btn =$('.add-user-group-btn') ;
        btn.html(loader);
        var postData = $("#add_user_group").serializeArray();
        jQuery.ajax(
            {
                url: '',
                type: "post",
                data: postData,
                success: function (response) {
                    var status = response['status'];
                    var value = response['value'];
                    var messages = response['messages'];
                    if (status) {
                        Alert.render('success', function () {
                            $('.empty').remove();
                            $('.user-groups-table').append(content.replace(/__name__/g, value['name']).replace(/__id__/g, value['id']));
                            btn.html('افزودن');
                            $('input[name=group-name]').val('');
                            __a = true;
                        });
                    }else{
                        var error = '';
                        for(var i = 0; i < messages.length ; i++){
                            error += messages[i] + '<br>';
                        }
                        if(error == '')
                            error = 'error';
                        Alert.render(error, function(){
                            btn.html('افزودن');
                            __a = true;
                        });
                    }
                },
                error: function () {
                    Alert.render('error', function(){
                        btn.html('افزودن');
                        __a = true;
                    });
                }
            });
    }
});

$(document).on('click', '.setting-group', function(e){
    var elm = $(e.target);
    var group_id = elm.attr('data-id');
    var postData = [
        {'name': 'group_id', 'value': group_id},
        {'name': 'action', 'value': 'setting'},
        {'name': '_xsrf', 'value': '{{ handler.xsrf_token }}'}
    ];
    jQuery.ajax(
        {
            url: '',
            type: "post",
            data: postData,
            success: function (response) {
                var value = response['value'];
                $('input[type=checkbox]').lcs_off();
                $('input[name=count-pattern-search]').val('');
                $('input[name=count-pattern-sources]').val('');
                $('input[name=bolton-name]').val('');
                $('input[name=time-edit-bolton]').val('');
                $('input[name=time-edit-newspaper]').val('');
                $('input[name=bolton-count]').val('');
                $('input[name=bolton-count-part]').val('');
                $('input[name=bolton-automatic-count]').val('');
                $('input[name=bolton-automatic-count-part]').val('');
                $('input[name=newspaper-count]').val('');
                $('input[name=newspaper-count-part]').val('');
                if(value['search_pattern']){
                    var s_p = value['search_pattern'];
                    if(s_p['simple_search']){
                        $('input[name=simple-search]').lcs_on();
                    }else{
                        $('input[name=simple-search]').lcs_off();
                    }
                    if(s_p['advanced_search']){
                        $('input[name=advanced-search]').lcs_on();
                    }else{
                        $('input[name=advanced-search]').lcs_off();
                    }
                    if(s_p['refining_news']){
                        $('input[name=refining-news]').lcs_on();
                    }else{
                        $('input[name=refining-news]').lcs_off();
                    }
                    if(s_p['pattern_sources']){
                        $('input[name=pattern-sources]').lcs_on();
                    }else{
                        $('input[name=pattern-sources]').lcs_off();
                    }
                    if(s_p['pattern_search']){
                        $('input[name=pattern-search]').lcs_on();
                    }else{
                        $('input[name=pattern-search]').lcs_off();
                    }
                    $('input[name=count-pattern-search]').val(s_p['count_pattern_search']);
                    $('input[name=count-pattern-sources]').val(s_p['count_pattern_sources']);

                }
                if(value['access_sources']){
                    var a_s = value['access_sources'];
                    for(var a = 0; a < a_s['agency'].length; a++){
                        $('input.child[name=agency][data-id=' + a_s['agency'][a] + ']').lcs_on();
                    }
                    for(var s = 0; s < a_s['subject'].length; s++){
                        $('input.child[name=subject][data-id=' + a_s['subject'][s] + ']').lcs_on();
                    }
                    for(var g = 0; g < a_s['geographic'].length; g++){
                        $('input.child[name=geographic][data-id=' + a_s['geographic'][g] + ']').lcs_on();
                    }
                }
                if(value['bolton_management']){
                    var b_m = value['bolton_management'];
                    $('input[name=bolton-name]').val(b_m['name']);
                    if(b_m['make_bolton']){
                        $('input[name=make-bolton]').lcs_on();
                        $('input[name=bolton-count]').removeAttr('disabled').val(b_m['bolton_count']);
                        $('input[name=bolton-count-part]').removeAttr('disabled').val(b_m['bolton_count_part']);
                    }else{
                        $('input[name=make-bolton]').lcs_off();
                        $('input[name=bolton-count]').val('').attr('disabled', 'disabled');
                        $('input[name=bolton-count-part]').val('').attr('disabled', 'disabled');
                    }
                    if(b_m['make_bolton_automatic']){
                        $('input[name=make-bolton-automatic]').lcs_on();
                        $('input[name=bolton-automatic-count]').removeAttr('disabled').val(b_m['bolton_automatic_count']);
                        $('input[name=bolton-automatic-count-part]').removeAttr('disabled').val(b_m['bolton_automatic_count_part']);
                    }else{
                        $('input[name=make-automatic-bolton]').lcs_off();
                        $('input[name=bolton-automatic-count]').val('').attr('disabled', 'disabled');
                        $('input[name=bolton-automatic-count-part]').val('').attr('disabled', 'disabled');
                    }
                    if(b_m['make_newspaper']){
                        $('input[name=make-newspaper]').lcs_on();
                        $('input[name=newspaper-count]').removeAttr('disabled').val(b_m['newspaper_count']);
                        $('input[name=newspaper-count-part]').removeAttr('disabled').val(b_m['newspaper_count_part']);
                    }else{
                        $('input[name=make-newspaper]').lcs_off();
                        $('input[name=newspaper-count]').val('').attr('disabled', 'disabled');
                        $('input[name=newspaper-count-part]').val('').attr('disabled', 'disabled');
                    }
                    $('input[name=time-edit-bolton]').val(b_m['time_edit_bolton']);
                    $('input[name=time-edit-newspaper]').val(b_m['time_edit_newspaper']);
                }
                if(value['charts_content']){
                    var c_c = value['charts_content'];
                    if(c_c['content_format']){
                        $('input[name=content-format]').lcs_on();
                    }else{
                        $('input[name=content-format]').lcs_off();
                    }
                    if(c_c['importance_news']){
                        $('input[name=importance-news]').lcs_on();
                    }else{
                        $('input[name=importance-news]').lcs_off();
                    }
                    if(c_c['based_count_news']){
                        $('input[name=based-count-news]').lcs_on();
                    }else{
                        $('input[name=based-count-news]').lcs_off();
                    }
                    if(c_c['stats_news']){
                        $('input[name=stats-news]').lcs_on();
                    }else{
                        $('input[name=stats-news]').lcs_off();
                    }
                    if(c_c['daily_news']){
                        $('input[name=daily-news]').lcs_on();
                    }else{
                        $('input[name=daily-news]').lcs_off();
                    }
                    if(c_c['news_headlines']){
                        $('input[name=news-headlines]').lcs_on();
                    }else{
                        $('input[name=news-headlines]').lcs_off();
                    }
                    if(c_c['tags_news']){
                        $('input[name=tags-news]').lcs_on();
                    }else{
                        $('input[name=tags-news]').lcs_off();
                    }
                    if(c_c['reflecting_news']){
                        $('input[name=reflecting-news]').lcs_on();
                    }else{
                        $('input[name=reflecting-news]').lcs_off();
                    }
                    if(c_c['importance_media']){
                        $('input[name=importance-media]').lcs_on();
                    }else{
                        $('input[name=importance-media]').lcs_off();
                    }
                    if(c_c['positive_negative_orientation']){
                        $('input[name=positive-negative-orientation]').lcs_on();
                    }else{
                        $('input[name=positive-negative-orientation]').lcs_off();
                    }
                    if(c_c['orientation_news_sources']){
                        $('input[name=orientation-news-sources]').lcs_on();
                    }else{
                        $('input[name=orientation-news-sources]').lcs_off();
                    }
                    if(c_c['important_news_makers']){
                        $('input[name=important-news-makers]').lcs_on();
                    }else{
                        $('input[name=important-news-makers]').lcs_off();
                    }
                    if(c_c['main_sources_news_1']){
                        $('input[name=main-sources-news-1]').lcs_on();
                    }else{
                        $('input[name=main-sources-news-1]').lcs_off();
                    }
                    if(c_c['main_sources_news_2']){
                        $('input[name=main-sources-news-2]').lcs_on();
                    }else{
                        $('input[name=main-sources-news-2]').lcs_off();
                    }
                }
                $('input.setting-group-id').val(group_id);
                $('#user_group_modal').modal('toggle');
            }
        });

});

var __b = true;
$('#search_and_patterns').submit(function(e){
    if(__b){
        __b = false;
        e.preventDefault();
        var btn =$('.search-and-patterns-btn') ;
        btn.html(loader);
        var postData = $("#search_and_patterns").serializeArray();
        jQuery.ajax(
            {
                url: '',
                type: "post",
                data: postData,
                success: function (response) {
                    var status = response['status'];
                    var value = response['value'];
                    var messages = response['messages'];
                    if (status) {
                        Alert.render('success', function () {
                            btn.html('ثبت');
                            __b = true;
                        });
                    }else{
                        var error = '';
                        for(var i = 0; i < messages.length ; i++){
                            error += messages[i] + '<br>';
                        }
                        if(error == '')
                            error = 'error';
                        Alert.render(error, function(){
                            btn.html('ثبت');
                            __b = true;
                        });
                    }
                },
                error: function () {
                    Alert.render('error', function(){
                        btn.html('ثبت');
                        __b = true;
                    });
                }
            });
    }
});

var __c = true;
$('#access_sources').submit(function(e){
    if(__c){
        __c = false;
        e.preventDefault();
        var btn =$('.access-source-btn') ;
        btn.html(loader);
        var postData = $("#access_sources").serializeArray();
        jQuery.ajax(
            {
                url: '',
                type: "post",
                data: postData,
                success: function (response) {
                    var status = response['status'];
                    var value = response['value'];
                    var messages = response['messages'];
                    if (status) {
                        Alert.render('success', function () {
                            btn.html('ثبت');
                            __c = true;
                        });
                    }else{
                        var error = '';
                        for(var i = 0; i < messages.length ; i++){
                            error += messages[i] + '<br>';
                        }
                        if(error == '')
                            error = 'error';
                        Alert.render(error, function(){
                            btn.html('ثبت');
                            __c = true;
                        });
                    }
                },
                error: function () {
                    Alert.render('error', function(){
                        btn.html('ثبت');
                        __c = true;
                    });
                }
            });
    }
});

var __d = true;
$('#bolton_management').submit(function(e){
    if(__d){
        __d = false;
        e.preventDefault();
        var btn =$('.bolton-management-btn') ;
        btn.html(loader);
        var postData = $("#bolton_management").serializeArray();
        jQuery.ajax(
            {
                url: '',
                type: "post",
                data: postData,
                success: function (response) {
                    var status = response['status'];
                    var value = response['value'];
                    var messages = response['messages'];
                    if (status) {
                        Alert.render('success', function () {
                            btn.html('ثبت');
                            __d = true;
                        });
                    }else{
                        var error = '';
                        for(var i = 0; i < messages.length ; i++){
                            error += messages[i] + '<br>';
                        }
                        if(error == '')
                            error = 'error';
                        Alert.render(error, function(){
                            btn.html('ثبت');
                            __d = true;
                        });
                    }
                },
                error: function () {
                    Alert.render('error', function(){
                        btn.html('ثبت');
                        __d = true;
                    });
                }
            });
    }
});

var __e = true;
$('#charts_content').submit(function(e){
    if(__e){
        __e = false;
        e.preventDefault();
        var btn =$('.charts-content-btn') ;
        btn.html(loader);
        var postData = $("#charts_content").serializeArray();
        jQuery.ajax(
            {
                url: '',
                type: "post",
                data: postData,
                success: function (response) {
                    var status = response['status'];
                    var value = response['value'];
                    var messages = response['messages'];
                    if (status) {
                        Alert.render('success', function () {
                            btn.html('ثبت');
                            __e = true;
                        });
                    }else{
                        var error = '';
                        for(var i = 0; i < messages.length ; i++){
                            error += messages[i] + '<br>';
                        }
                        if(error == '')
                            error = 'error';
                        Alert.render(error, function(){
                            btn.html('ثبت');
                            __e = true;
                        });
                    }
                },
                error: function () {
                    Alert.render('error', function(){
                        btn.html('ثبت');
                        __e = true;
                    });
                }
            });
    }
});

    var __g = true;
    $(document).on('click', '.delete-group', function(e){
        if(__g){
            __g = false;
            var elm = $(e.target).closest('.delete-group');
            var group = elm.attr('data-group');
            elm.html(loader.replace(/20/g, '15'));
            var postData = [
                {name: 'group', value: group},
                {name: '_xsrf', value: '{{ handler.xsrf_token }}'},
                {name: 'action', value: 'delete'}
            ];
            jQuery.ajax(
                {
                    url: '',
                    type: "post",
                    data: postData,
                    success: function (response) {
                        var status = response['status'];
                        var value = response['value'];
                        var messages = response['messages'];
                        if (status) {
                            Alert.render('success', function () {
                                elm.closest('.group-row').remove();
                                __g = true;
                            });
                        }else{
                            var error = '';
                            for(var i = 0; i < messages.length ; i++){
                                error += messages[i] + '<br>';
                            }
                            if(error == '')
                                error = 'error';
                            Alert.render(error, function(){
                                elm.html(trash);
                                __g = true;
                            });
                        }
                    },
                    error: function () {
                        Alert.render('error', function(){
                            elm.html(trash);
                            __g = true;
                        });
                    }
                });
        }
    });

</script>
{% end block other_scripts %}